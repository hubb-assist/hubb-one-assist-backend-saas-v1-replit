Prompt para Replit â€” Criar o MÃ³dulo subscribers (Assinantes do Sistema)
OlÃ¡ Replit!
Vamos criar o mÃ³dulo de assinantes do sistema (no backend) â€” tambÃ©m chamados de subscribers.

Esses sÃ£o os usuÃ¡rios especiais que contratam a plataforma HUBB ONE e terÃ£o acesso ao seu prÃ³prio painel com pacientes, finanÃ§as, etc.

ğŸ§© Nome do modelo: Subscriber
Em portuguÃªs: Assinante
Em inglÃªs (no cÃ³digo): Subscriber

âœ… Campos obrigatÃ³rios no modelo SQLAlchemy:
python
Copiar
Editar
class Subscriber(Base):
    __tablename__ = "subscribers"

    id = Column(UUID, primary_key=True, index=True, default=uuid4)
    name = Column(String, nullable=False)  # Nome do responsÃ¡vel
    clinic_name = Column(String, nullable=False)
    email = Column(String, unique=True, index=True)
    phone = Column(String)
    document = Column(String, unique=True)  # CPF ou CNPJ
    zip_code = Column(String)
    address = Column(String)
    city = Column(String)
    state = Column(String)
    segment_id = Column(UUID, ForeignKey("segments.id"))  # â† Relacionamento com segmentos
    plan_id = Column(UUID, ForeignKey("plans.id"))
    is_active = Column(Boolean, default=True)
    created_at = Column(DateTime, default=datetime.utcnow)
ğŸ”— Relacionamento com segmentos:
Um Subscriber deve estar vinculado a um segment_id

Isso define se Ã© uma clÃ­nica mÃ©dica, veterinÃ¡ria, odontolÃ³gica, etc.

O campo deve ser validado no Pydantic

ğŸ”— Relacionamento com User:
Ao criar um assinante, o sistema tambÃ©m criarÃ¡ um User

Este User serÃ¡ o dono do assinante (role = DONO_ASSINANTE) e terÃ¡ subscriber_id

Todos os usuÃ¡rios de uma clÃ­nica terÃ£o esse subscriber_id no token

âœ… Endpoints esperados:
MÃ©todo	Endpoint	DescriÃ§Ã£o
GET	/subscribers/	Listar assinantes
GET	/subscribers/{id}	Detalhes de um assinante
POST	/subscribers/	Criar novo assinante + usuÃ¡rio
PUT	/subscribers/{id}	Atualizar dados
DELETE	/subscribers/{id}	Desativar ou remover assinante

ğŸ§¾ Schemas esperados (Pydantic):
SubscriberCreate

SubscriberUpdate

SubscriberResponse

PaginatedSubscriberResponse (opcional)

Inclua segment_id, plan_id, e os campos bÃ¡sicos descritos acima.

ğŸ” Regras de acesso:
Os endpoints devem ser protegidos para SUPER_ADMIN (no painel admin)

O endpoint /subscribers/ tambÃ©m serÃ¡ usado pelo formulÃ¡rio pÃºblico de onboarding (sem token) â€” mas com validaÃ§Ãµes internas

ğŸ§  Importante:
O campo segment_id deve vir do frontend no onboarding

O User criado com o assinante deve ter:

subscriber_id

role = DONO_ASSINANTE

senha gerada na hora (recebida do formulÃ¡rio)

ApÃ³s esse mÃ³dulo estar pronto, poderemos:

Criar o formulÃ¡rio pÃºblico de onboarding (multi-etapas)

Criar o login isolado para assinantes

Gerar instÃ¢ncias reais no banco com isolamento de dados por subscriber_id

